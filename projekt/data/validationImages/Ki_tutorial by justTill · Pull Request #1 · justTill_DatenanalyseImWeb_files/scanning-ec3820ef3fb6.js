"use strict";(()=>{var Z=Object.defineProperty;var c=(v,E)=>Z(v,"name",{value:E,configurable:!0});(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["scanning"],{43721:(v,E,g)=>{g.d(E,{ZG:()=>T,q6:()=>i,w4:()=>N});var y=g(8439);let S=!1;const x=new y.Z;function _(d){const l=d.target;if(l instanceof HTMLElement&&l.nodeType!==Node.DOCUMENT_NODE)for(const u of x.matches(l))u.data.call(null,l)}c(_,"handleFocus");function T(d,l){S||(S=!0,document.addEventListener("focus",_,!0)),x.add(d,l),document.activeElement instanceof HTMLElement&&document.activeElement.matches(d)&&l(document.activeElement)}c(T,"onFocus");function N(d,l,u){function m(f){const w=f.currentTarget;!w||(w.removeEventListener(d,u),w.removeEventListener("blur",m))}c(m,"blurHandler"),T(l,function(f){f.addEventListener(d,u),f.addEventListener("blur",m)})}c(N,"onKey");function i(d,l){function u(m){const{currentTarget:f}=m;!f||(f.removeEventListener("input",l),f.removeEventListener("blur",u))}c(u,"blurHandler"),T(d,function(m){m.addEventListener("input",l),m.addEventListener("blur",u)})}c(i,"onInput")},5638:(v,E,g)=>{g.d(E,{r:()=>y});function y(S,x){const _=S.createElement("template");return _.innerHTML=x,S.importNode(_.content,!0)}c(y,"parseHTML")},50320:(v,E,g)=>{g.d(E,{Om:()=>_,lp:()=>S,rq:()=>y,t4:()=>x,yb:()=>N});function y(i){const d="\u200D",l=i.split(d);let u=0;for(const m of l)u+=Array.from(m.split(/[\ufe00-\ufe0f]/).join("")).length;return u/l.length}c(y,"getUtf8StringLength");function S(i,d,l){let u=i.value.substring(0,i.selectionEnd||0),m=i.value.substring(i.selectionEnd||0);return u=u.replace(d,l),m=m.replace(d,l),T(i,u+m,u.length),l}c(S,"replaceText");function x(i,d,l){if(i.selectionStart===null||i.selectionEnd===null)return S(i,d,l);const u=i.value.substring(0,i.selectionStart),m=i.value.substring(i.selectionEnd);return T(i,u+l+m,u.length),l}c(x,"replaceSelection");function _(i,d,l={}){const u=i.selectionEnd||0,m=i.value.substring(0,u),f=i.value.substring(u),w=i.value===""||m.match(/\n$/)?"":`
`,I=l.appendNewline?`
`:"",j=w+d+I;i.value=m+j+f;const L=u+j.length;return i.selectionStart=L,i.selectionEnd=L,i.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!1})),i.focus(),j}c(_,"insertText");function T(i,d,l){i.value=d,i.selectionStart=l,i.selectionEnd=l,i.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!1}))}c(T,"setTextareaValueAndCursor");function N(i,d){const l=[...i],u=new TextEncoder,m=new Uint8Array(4);for(let f=0;f<l.length;f++){const w=l[f],{written:I,read:j}=u.encodeInto(w,m);if(!I||!j)return-1;const L=I-j;if(L!==0&&(f<d&&(d-=L),f>=d))break}return d}c(N,"GetCharIndexFromBytePosition")},26628:(v,E,g)=>{var y=g(59753);function S(t){const e=document.createElement("input");return e.setAttribute("type","hidden"),e.setAttribute("name",t.name),e.setAttribute("value",t.value),e}c(S,"copyInput");function x(t){let e=!1;const n=t.querySelectorAll(".js-scanning-fixed-alert-numbers"),o=n.length!==0?JSON.parse(n[0].getAttribute("data-numbers")||"[]"):[];for(const s of t.querySelectorAll(".js-scanning-bulk-action-items")){s.innerHTML="";const r=t.querySelectorAll(".js-scanning-alert-list [data-check-all-item]:checked");for(const a of r)e||(e=o.indexOf(parseInt(a.value))!==-1),s.appendChild(S(a))}for(const s of t.querySelectorAll(".js-scanning-reopen-button"))s.hidden=e;for(const s of t.querySelectorAll(".js-scanning-reopen-button-disabled"))s.hidden=!e}c(x,"copyCheckedAlertsToBulkActionForms"),(0,y.on)("change",".js-scanning-alert-check",function({currentTarget:t}){const e=t.closest(".js-scanning-alert-list"),n=e.querySelector(".js-scanning-alert-check:checked")!=null,o=e.querySelector(".js-scanning-filter-options"),s=e.querySelector(".js-scanning-alert-bulk-actions"),r=e.querySelector(".js-scanning-alert-links");o&&(o.hidden=n),s&&(s.hidden=!n),r&&(r.hidden=n),x(e)}),(0,y.on)("details-menu-selected",".js-scanning-code-path-menu",function(t){const e=t.detail.relatedTarget.getAttribute("data-target-code-path");for(const n of document.querySelectorAll(".js-scanning-code-path"))n.hidden=e!==n.getAttribute("data-code-path")},{capture:!0});var _=g(43721),T=g(69567),N=g(46263),i=g(64463),d=g(5638),l=g(50320);(0,i.N7)(".js-add-secret-format-button",{add(){window.postProcessingExpressionCount=0;const t=document.querySelector(".js-post-processing-expression-count");t&&t.textContent&&(window.postProcessingExpressionCount=parseInt(t.textContent))}}),(0,y.on)("click",".js-add-secret-format-button",t=>{const e=t.currentTarget;if(!!e&&window.postProcessingExpressionCount<D()){const n=document.querySelectorAll(".js-additional-secret-format");if(!n)return;for(const o of n)if(o.classList.contains("has-removed-contents")){o.classList.toggle("has-removed-contents",!1),window.postProcessingExpressionCount++,window.postProcessingExpressionCount===D()&&(e.hidden=!0);break}}}),(0,y.on)("click",".js-remove-secret-format-button",t=>{var e,n;const o=document.querySelector(".js-add-secret-format-button");if(!o)return;const s=t.currentTarget;if(!s)return;const r=s.closest(".js-additional-secret-format");if(!r)return;r.classList.toggle("has-removed-contents",!0);const a=r.getElementsByClassName("js-post-processing-input")[0];a.value="";const b=Array.from(r.getElementsByClassName("js-post-processing-input-rule")),p=r.getElementsByClassName("errored")[0];p&&p.classList.toggle("errored",!1);for(const h of b)(e=document.getElementById(`${h.id}_hidden`))==null||e.remove();(n=document.getElementById(`${a.id}_hidden`))==null||n.remove(),I(window.codeEditor.getValue()),window.postProcessingExpressionCount--,window.postProcessingExpressionCount<D()&&(o.hidden=!1)}),(0,i.N7)(".js-test-code",{async add(){const t=document.querySelector(".js-test-code"),e=t.clientHeight,n=await g.e("vendors-node_modules_codemirror_lib_codemirror_js").then(g.t.bind(g,4631,23));if(window.codeEditor=n.default.fromTextArea(t,{lineNumbers:!1,lineWrapping:!0,mode:"text/x-yaml",inputStyle:"contenteditable",value:t.value,lineSeparator:`\r
`,theme:"github-light"}),e!==0){const r=document.querySelector(".CodeMirror");r&&(r.style.height=`${e}px`,r.style.border="1px solid #e1e4e8",r.style.borderRadius="6px")}window.codeEditor.save();const o=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!o)return;let s=I;o.hasAttribute("data-source-is-readonly")&&(s=J),window.codeEditor.on("change",()=>{s(window.codeEditor.getValue())})}}),(0,_.q6)(".js-custom-secret-scanning-pattern-form *",async function(){!window.codeEditor||I(window.codeEditor.getValue())}),(0,y.on)("click",".js-repo-selector-dialog-summary-button.disabled",t=>{t.preventDefault()}),(0,y.on)("click",".js-save-and-dry-run-button, .js-custom-pattern-submit-button, .js-org-repo-selector-dialog-dry-run-button",t=>{t.preventDefault();const e=u(t);if(!e)return;m(e);const n=f();!n||((e.className.includes("js-save-and-dry-run-button")||e.className.includes("js-org-repo-selector-dialog-dry-run-button"))&&w(n,"submit_type","save_and_dry_run"),(0,y.f)(n,"submit"))});function u(t){return t.currentTarget}c(u,"getSubmitButton");function m(t){t.textContent=t.getAttribute("data-disable-with")||"",t.disabled=!0}c(m,"setSubmitButtonDisableWith");function f(){return document.querySelector(".js-custom-secret-scanning-pattern-form")}c(f,"getCustomPatternForm");const w=c((t,e,n)=>{const o=document.createElement("input");o.type="hidden",o.name=e,o.id=`${e}_hidden`,o.value=n,t.appendChild(o),o.required=!0},"createHiddenInputField"),I=(0,N.D)(function(t){const e=document.querySelector(".js-custom-pattern-submit-button"),n=document.querySelector(".js-save-and-dry-run-button"),o=document.querySelector(".js-repo-selector-dialog-summary-button"),s=document.querySelector(".js-update-pattern-info"),r=document.querySelector(".js-test-pattern-matches");if(!!r)if(t.length===0){const a=document.querySelector(".js-dry-run-status");if(!a)return;z(a)||e==null||e.setAttribute("disabled","true"),n==null||n.setAttribute("disabled","true"),o==null||o.classList.add("disabled"),r.textContent=""}else{window.codeEditor.save();const a=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(a instanceof HTMLFormElement))return;const b=f();if(!b)return;for(const p of b.elements)if(p instanceof HTMLInputElement&&p.name&&(p.type==="text"||p.type==="radio"&&p.checked)){const h=document.getElementById(`${p.name}_hidden`);h!==null&&h.remove(),w(a,p.name,p.value)}R(a,L(b,e,n,o,s),j(r))}},300),j=c(t=>e=>{if(e.length===0)t.textContent=" - No matches";else if(e.length===1)t.textContent=" - 1 match";else{const n=[];for(const r of e)n.push(JSON.stringify(r));const s=[...new Set(n)];t.textContent=` - ${s.length} matches`}},"getTestLabelUpdater"),L=c((t,e,n,o,s)=>r=>{var a,b,p;if($(t),r==null?void 0:r.message){if(e==null||e.setAttribute("disabled","true"),n==null||n.setAttribute("disabled","true"),o==null||o.classList.add("disabled"),s)s.hidden=!0;else if((r==null?void 0:r.error_type)==="START_DELIMITER"||(r==null?void 0:r.error_type)==="END_DELIMITER"||(r==null?void 0:r.error_type)==="MUST_MATCH"||(r==null?void 0:r.error_type)==="MUST_NOT_MATCH"){const h=document.querySelector(".js-more-options.js-details-container");h&&(h.classList.add("open"),h.classList.add("Details--on"))}return H(t,r),!1}else{const h=document.querySelector(".js-mode");if(!h)return!1;const C=document.querySelector(".js-dry-run-status");return C?((((a=C.textContent)==null?void 0:a.toLowerCase())==="cancelled"||((b=C.textContent)==null?void 0:b.toLowerCase())==="skipped"||((p=h.textContent)==null?void 0:p.toLowerCase())!=="unpublished")&&(e==null||e.removeAttribute("disabled")),o==null||o.classList.remove("disabled"),n==null||n.removeAttribute("disabled"),s&&(s.hidden=!1),!0):!1}},"getTestErrorHandler");function H(t,e){var n;if(e.error_type==="MUST_MATCH"||e.error_type==="MUST_NOT_MATCH"){let o=0;const s=t.getElementsByClassName("js-additional-secret-format");for(const r of s){if(o>(e.error_index||0))return;const b=[...r.getElementsByTagName("input")].filter(k=>k.checked),p=b&&((n=b[0])==null?void 0:n.value.toUpperCase()),h=p===e.error_type&&o===e.error_index,q=[...r.getElementsByTagName("input")].filter(k=>k.type==="text");if(!q||q.length===0)continue;const A=q[0];if(A.value!=="")if(h){const k=A.id;A&&A.parentElement&&F(A.parentElement);const M=document.createElement("p"),O=`${k}_error_message`;M.classList.add("note","error","mt-5"),M.id=O,M.textContent=e.message,A==null||A.setAttribute("aria-describedby",O),A==null||A.insertAdjacentElement("afterend",M);return}else p===e.error_type&&o++}}else{const o=V[e.error_type],s=document.querySelector(`#${o}`);s&&s.parentElement&&F(s.parentElement);const r=document.createElement("p"),a=`${o}_error_message`;r.classList.add("note","error"),r.id=a,r.textContent=e.message,s==null||s.setAttribute("aria-describedby",a),s==null||s.insertAdjacentElement("afterend",r)}}c(H,"showInputErrorState");function $(t){var e,n;const o=document.querySelector(".js-error-banner");o.hidden=!0;for(const s of t.getElementsByTagName("input"))if((e=s.parentElement)==null?void 0:e.classList.contains("errored")){U(s.parentElement);const r=s.getAttribute("aria-describedby");(n=document.querySelector(`#${r}`))==null||n.remove()}}c($,"clearInputErrorState");function D(){const t=document.querySelector(".js-post-processing-expression-max-count");if(!t)return 5;const e=t.textContent;return e?parseInt(e):5}c(D,"getMaxPostProcessingExpressions");function F(t){t==null||t.classList.add("form-group","errored","my-0")}c(F,"addErrorStylingToInput");function U(t){t==null||t.classList.remove("form-group","errored","my-0")}c(U,"removeErrorStylingFromInput");function P(){if(!window.codeEditor)return;const t=window.codeEditor.posFromIndex(0),e=window.codeEditor.posFromIndex(window.codeEditor.getValue().length);for(const n of window.codeEditor.findMarks(t,e))n.clear()}c(P,"clearCodeHighlights");function z(t){var e,n;return((e=t.textContent)==null?void 0:e.toLowerCase())==="queued"||((n=t.textContent)==null?void 0:n.toLowerCase())==="inprogress"}c(z,"allowDryRunCancellation");const V={NONE:"",CONFIG_LOAD:"secret_format",COMPILE_DB:"secret_format",START_DELIMITER:"before_secret",END_DELIMITER:"after_secret",DISPLAY_NAME:"display_name"};async function R(t,e,n){let o;try{const s=await fetch(t.action,{method:t.method,body:new FormData(t),headers:{Accept:"application/json"}});s.ok&&(o=await s.json())}catch{}if(o&&e(o.error))if(o.has_matches){const s=JSON.parse(o.matches);P(),n(s);for(const r of s)W(window.codeEditor,r.start,r.end)}else n([]),P()}c(R,"updatePatternMatches");const J=(0,N.D)(function(t){const e=document.querySelector(".js-test-custom-secret-scanning-pattern");if(!(e instanceof HTMLFormElement))return;const n=document.querySelector(".js-test-pattern-matches");if(!!n)if(t.length===0)n.textContent="";else{if(!window.codeEditor)return;window.codeEditor.save(),R(e,()=>!0,j(n))}},300);function W(t,e,n){const o=t.getValue();if(e=(0,l.yb)(o,e),n=(0,l.yb)(o,n),e===-1||n===-1)return;const s=t.posFromIndex(e),r=t.posFromIndex(n);t.markText(s,r,{className:"text-bold hx_keyword-hl rounded-2 d-inline-block"})}c(W,"MarkMatch");async function G(t){const e=t.currentTarget;t.preventDefault(),B(e,parseInt(e.remove_repo_id.value),!1)}c(G,"removeDryRunRepo");async function B(t,e,n){const o=document.getElementById("selected_repo_ids");if(!o)return;const s=document.querySelector(".js-org-repo-selector-dialog-dry-run-button");if(!s)return;const r=JSON.parse(o.value),a=new Set(r);n?a.size<K()&&a.add(e):a.delete(e),o.value=JSON.stringify(Array.from(a)),a.size>0?s.removeAttribute("disabled"):s.setAttribute("disabled","true");const b=new FormData(t);b.append("selected_repo_ids",o.value);const p=await fetch(t.action,{method:t.method,body:b,headers:{Accept:"text/fragment+html"}});if(p.status>=400){const h="An unknown error occurred.",C=document.querySelector("template.js-flash-template");C.after(new T.R(C,{className:"flash-error",message:h}))}else{const h=document.querySelector(".js-dry-run-selected-repos"),C=(0,d.r)(document,await p.text());h.replaceWith(C)}}c(B,"updateDryRunSelectedRepos"),(0,y.on)("click",".js-remove-dry-run-repo-form",G),(0,y.on)("auto-complete-change",".js-dry-run-repo-autocomplete",function(t){const e=t.target;if(!e.value)return;if(e.value.includes("No repositories found.")){e.value="";return}const n=e.closest("form");B(n,parseInt(n.repo_id.value),!0),e.value=""}),(0,_.w4)("keydown",".js-dry-run-repo-autocomplete-input",function(t){t.key==="Enter"&&t.preventDefault()});function K(){const t=document.querySelector(".js-dry-run-selected-repos-max-count");if(!t)return 10;const e=t.textContent;return e?parseInt(e):10}c(K,"getMaxDryRunSelectedRepos")}},v=>{var E=c(y=>v(v.s=y),"__webpack_exec__");v.O(0,["vendors-node_modules_selector-observer_dist_index_esm_js","vendors-node_modules_github_mini-throttle_dist_index_js-node_modules_delegated-events_dist_in-3fcf56"],()=>E(26628));var g=v.O()}]);})();

//# sourceMappingURL=scanning-62485a9f0014.js.map